# 100-prisoners-problem
100 prisoners problem in Haskell

https://en.wikipedia.org/wiki/100_prisoners_problem

# Code 
```haskell
import System.Random.Shuffle

prisoners = [0..99]

pcycle cupboard drawerNo prisonerNo attempts
  | cupboard !! drawerNo == prisonerNo = attempts
  | otherwise = pcycle cupboard (cupboard !! drawerNo) prisonerNo (attempts + 1)

main = do
  rand <- shuffleM prisoners
  let result = map (\x -> pcycle rand x x 1) prisoners
  print result
  putStr $ "Did the prisoners surive? "
  return $ all (< 51) result
```

# Usage
`ghci prisoners.hs` (or compile it if you like)

Example Result
```haskell
*Main Control.Monad> main
[38,11,28,11,11,28,38,28,20,38,38,38,38,20,11,38,38,38,28,28,38,38,20,28,28,38,38,28,28,20,38,28,20,28,38,28,38,20,38,28,38,28,28,11,11,38,2,28,38,28,38,20,11,20,20,20,28,20,28,38,20,38,38,20,38,28,20,11,38,28,38,38,38,20,38,28,38,20,38,38,38,38,28,20,1,28,20,38,28,11,38,20,2,28,11,38,11,28,20,28]
Did the prisoners surive? True
```
The lists shows how many attempts were necessary until each prisoner found his number (e.g the first prisoner opened 38 drawers).

### 1000 Experiments
```haskell
 length <$> filter id <$> replicateM 1000 main

...
Did the prisoners surive? False
[49,20,49,20,49,49,20,31,31,49,31,49,20,20,31,49,49,49,31,31,31,49,20,20,20,31,49,31,20,31,31,49,49,31,31,49,49,49,49,49,49,31,49,49,49,20,20,49,49,49,31,49,31,31,20,31,49,31,31,31,20,49,49,49,49,49,49,31,49,31,20,49,20,31,49,49,49,31,49,49,49,49,20,20,31,49,20,20,31,49,49,31,49,49,31,31,31,49,49,20]
Did the prisoners surive? True
[86,86,86,86,86,86,86,86,86,86,86,86,6,86,86,86,86,86,86,86,1,86,86,86,86,6,86,6,86,6,86,86,86,86,86,86,1,86,86,86,86,86,86,6,86,86,6,86,86,6,86,86,86,86,86,86,6,86,86,86,86,86,86,86,86,86,86,86,86,86,6,86,86,86,86,6,86,86,6,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,6]
Did the prisoners surive? False
[61,32,61,32,61,32,61,32,61,61,61,61,61,61,61,61,32,61,32,61,32,61,32,61,32,61,61,61,32,61,61,61,61,61,32,61,61,6,61,32,61,32,32,32,61,61,61,61,61,61,6,61,32,32,61,32,61,61,61,61,32,61,32,32,61,61,32,61,61,61,32,61,6,61,32,6,61,61,61,32,32,61,61,61,6,61,61,32,61,32,61,1,61,32,32,61,6,61,32,32]
Did the prisoners surive? False
[6,22,6,22,62,62,22,22,62,62,22,22,62,6,62,22,62,62,22,62,62,22,22,62,62,10,10,62,62,62,62,62,62,22,62,62,62,62,62,62,62,22,10,10,22,62,10,62,62,22,62,6,62,22,62,22,22,22,62,10,62,10,62,62,62,22,22,62,62,62,62,62,22,62,62,22,62,62,62,62,62,62,62,62,62,62,62,62,6,10,6,62,62,62,62,62,10,62,10,62]
Did the prisoners surive? False
[33,5,33,33,33,52,52,52,52,33,52,52,33,52,52,52,33,2,33,52,52,2,33,33,33,52,33,52,33,52,52,52,33,33,52,33,52,33,33,52,33,52,1,52,7,33,33,7,52,52,52,7,33,33,52,52,52,52,52,52,52,52,33,33,52,33,52,52,52,52,52,33,33,52,5,33,7,52,33,52,5,7,7,5,52,33,52,52,52,33,33,52,52,5,7,52,52,52,52,52]
Did the prisoners surive? False
[70,10,10,70,70,70,70,70,70,10,70,70,70,10,70,70,70,70,70,1,70,70,70,15,70,70,70,70,70,70,70,10,10,70,70,1,70,70,70,15,70,70,70,70,15,15,70,70,70,70,70,70,70,10,15,70,70,70,70,15,15,15,70,70,70,70,70,70,70,70,10,70,70,70,70,15,3,10,70,15,3,70,70,3,70,70,15,70,70,70,15,70,15,70,15,15,70,70,10,70]
Did the prisoners surive? False
[2,76,76,76,76,76,76,76,76,76,76,76,9,76,76,76,76,76,76,76,76,7,76,7,76,6,76,76,7,9,9,76,76,9,6,76,76,7,76,76,76,76,76,76,76,76,76,9,9,76,6,76,76,2,7,76,76,76,76,76,76,76,76,6,76,76,76,76,76,9,76,76,76,76,76,76,76,7,9,76,76,76,76,7,76,76,76,76,76,76,6,6,76,76,76,76,9,76,76,76]
Did the prisoners surive? False
287
```

Last numbers shows how often the prisoners survived (287 of 1000 times). Statistically it should be ~31%.
